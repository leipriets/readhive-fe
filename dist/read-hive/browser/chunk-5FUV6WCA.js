import{a as xe,b as Ne}from"./chunk-6MQQRE37.js";import{$ as P,Cb as Ee,F as D,_ as O,eb as Z,fa as Se,fb as q,ga as _e,j as Ce,mb as Ie,rb as ke,sb as be,vb as De,wb as Pe}from"./chunk-KYAOKWVV.js";import{A as I,Db as he,E as A,Gb as T,Ha as re,Ia as z,Ja as w,Jb as me,Kb as $,L as ee,Lb as M,Mb as b,Mc as Y,Oa as N,Pc as we,Ra as H,Sa as ae,Sb as R,Ub as V,Va as ce,Vb as j,Wb as G,Xb as l,Yb as d,Yc as ye,Zb as g,bc as F,cc as pe,da as te,dc as u,ea as h,ec as de,f as S,fc as p,gc as ge,hc as fe,kc as B,la as ie,lc as U,m as _,ma as ne,mb as le,mc as Q,oc as ue,pb as m,qa as k,qb as c,ra as W,rc as ve,vc as ze,wa as L,wc as K,xa as oe,ya as se}from"./chunk-DZ3RKEIN.js";import{a as f}from"./chunk-GAL4ENT6.js";var Le=["*"],He=["imgRef"],$e=["imagePreviewWrapper"];function Ve(t,s){if(t&1){let e=F();l(0,"div",13),u("click",function(i){z(e);let o=p();return w(o.onSwitchLeft(i))}),g(1,"span",14),d(),l(2,"div",15),u("click",function(i){z(e);let o=p();return w(o.onSwitchRight(i))}),g(3,"span",16),d()}if(t&2){let e=p();b("ant-image-preview-switch-left-disabled",e.index<=0),m(2),b("ant-image-preview-switch-right-disabled",e.index>=e.images.length-1)}}function je(t,s){if(t&1&&(l(0,"li",5),ue(1),d()),t&2){let e=p();m(),ve("",e.index+1," / ",e.images.length,"")}}function Ge(t,s){if(t&1){let e=F();l(0,"li",17),u("click",function(){let i=z(e).$implicit;return w(i.onClick())}),g(1,"span",18),d()}if(t&2){let e,n=s.$implicit,i=p();b("ant-image-preview-operations-operation-disabled",i.zoomOutDisabled&&n.type==="zoomOut"),m(),$("nzType",n.icon)("nzRotate",(e=n.rotate)!==null&&e!==void 0?e:0)}}function Be(t,s){if(t&1&&g(0,"img",20,1),t&2){let e=p().$implicit,n=p();M("width",e.width)("height",e.height)("transform",n.previewImageTransform),me("src",n.sanitizerResourceUrl(e.src),le)("srcset",e.srcset)("alt",e.alt)}}function Ue(t,s){if(t&1&&T(0,Be,2,9,"img",19),t&2){let e=s.$index,n=p();R(e===n.index?0:-1)}}var Qe=(()=>{class t{constructor(){this.nzScaleStep=null,this.images=[]}addImage(e){this.images.push(e)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=L({type:t,selectors:[["nz-image-group"]],inputs:{nzScaleStep:"nzScaleStep"},exportAs:["nzImageGroup"],standalone:!0,features:[K],ngContentSelectors:Le,decls:1,vars:0,template:function(n,i){n&1&&(ge(),fe(0))},encapsulation:2,changeDetection:0})}}return t})();var Ze="image";function Ke(t){let s={};return t.width<=t.clientWidth&&t.height<=t.clientHeight&&(s={x:0,y:0}),(t.width>t.clientWidth||t.height>t.clientHeight)&&(s={x:Fe(t.left,t.width,t.clientWidth),y:Fe(t.top,t.height,t.clientHeight)}),s}function Ye(t){let s=t.getBoundingClientRect(),e=document.documentElement;return{left:s.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||document.body.clientLeft||0),top:s.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||document.body.clientTop||0)}}function qe(){let t=document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight;return{width:t,height:s}}function Fe(t,s,e){let n=t+s,i=(s-e)/2,o=null;return s>e?(t>0&&(o=i),t<0&&n<e&&(o=-i)):(t<0||n>e)&&(o=t<0?i:-i),o}var E=class{constructor(){this.nzKeyboard=!0,this.nzNoAnimation=!1,this.nzMaskClosable=!0,this.nzCloseOnNavigation=!0}},Oe={x:0,y:0},X=.5,Xe=1,Je=0,Ae=(()=>{class t{get animationDisabled(){return this.config.nzNoAnimation??!1}get maskClosable(){let e=this.nzConfigService.getConfigForComponent(Ze)||{};return this.config.nzMaskClosable??e.nzMaskClosable??!0}constructor(e,n,i,o,a,r){this.ngZone=e,this.cdr=n,this.nzConfigService=i,this.config=o,this.destroy$=a,this.sanitizer=r,this._defaultNzZoom=Xe,this._defaultNzScaleStep=X,this._defaultNzRotate=Je,this.images=[],this.index=0,this.isDragging=!1,this.visible=!0,this.animationStateChanged=new H,this.scaleStepMap=new Map,this.previewImageTransform="",this.previewImageWrapperTransform="",this.operations=[{icon:"close",onClick:()=>{this.onClose()},type:"close"},{icon:"zoom-in",onClick:()=>{this.onZoomIn()},type:"zoomIn"},{icon:"zoom-out",onClick:()=>{this.onZoomOut()},type:"zoomOut"},{icon:"rotate-right",onClick:()=>{this.onRotateRight()},type:"rotateRight"},{icon:"rotate-left",onClick:()=>{this.onRotateLeft()},type:"rotateLeft"},{icon:"swap",onClick:()=>{this.onHorizontalFlip()},type:"flipHorizontally"},{icon:"swap",onClick:()=>{this.onVerticalFlip()},type:"flipVertically",rotate:90}],this.zoomOutDisabled=!1,this.position=f({},Oe),this.closeClick=new H,this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.flipHorizontally=this.config.nzFlipHorizontally??!1,this.flipVertically=this.config.nzFlipVertically??!1,this.updateZoomOutDisabled(),this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform()}ngOnInit(){this.ngZone.runOutsideAngular(()=>{I(this.imagePreviewWrapper.nativeElement,"mousedown").pipe(h(this.destroy$)).subscribe(()=>{this.isDragging=!0}),I(this.imagePreviewWrapper.nativeElement,"wheel").pipe(h(this.destroy$)).subscribe(e=>{this.ngZone.run(()=>this.wheelZoomEventHandler(e))})})}setImages(e,n){n&&(this.scaleStepMap=n),this.images=e,this.markForCheck()}switchTo(e){this.index=e,this.markForCheck()}next(){this.index<this.images.length-1&&(this.reset(),this.index++,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}prev(){this.index>0&&(this.reset(),this.index--,this.updatePreviewImageTransform(),this.updatePreviewImageWrapperTransform(),this.updateZoomOutDisabled(),this.markForCheck())}markForCheck(){this.cdr.markForCheck()}onClose(){this.visible=!1,this.closeClick.emit()}onZoomIn(){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom+=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled()}onZoomOut(){if(this.zoom>1){let e=this.scaleStepMap.get(this.images[this.index].src??this.images[this.index].srcset)??this.scaleStep;this.zoom-=e,this.updatePreviewImageTransform(),this.updateZoomOutDisabled(),this.zoom<=1&&this.reCenterImage()}}onRotateRight(){this.rotate+=90,this.updatePreviewImageTransform()}onRotateLeft(){this.rotate-=90,this.updatePreviewImageTransform()}onSwitchLeft(e){e.preventDefault(),e.stopPropagation(),this.prev()}onSwitchRight(e){e.preventDefault(),e.stopPropagation(),this.next()}onHorizontalFlip(){this.flipHorizontally=!this.flipHorizontally,this.updatePreviewImageTransform()}onVerticalFlip(){this.flipVertically=!this.flipVertically,this.updatePreviewImageTransform()}wheelZoomEventHandler(e){e.preventDefault(),e.stopPropagation(),this.handlerImageTransformationWhileZoomingWithMouse(e,e.deltaY),this.handleImageScaleWhileZoomingWithMouse(e.deltaY),this.updatePreviewImageWrapperTransform(),this.updatePreviewImageTransform(),this.markForCheck()}onAnimationStart(e){this.animationStateChanged.emit(e)}onAnimationDone(e){this.animationStateChanged.emit(e)}onDragEnd(e){this.isDragging=!1;let n=this.imageRef.nativeElement.offsetWidth*this.zoom,i=this.imageRef.nativeElement.offsetHeight*this.zoom,{left:o,top:a}=Ye(this.imageRef.nativeElement),{width:r,height:v}=qe(),x=this.rotate%180!==0,C=Ke({width:x?i:n,height:x?n:i,left:o,top:a,clientWidth:r,clientHeight:v});D(C.x)||D(C.y)?this.position=f(f({},this.position),C):!D(C.x)&&!D(C.y)&&(this.position={x:e.source.getFreeDragPosition().x,y:e.source.getFreeDragPosition().y})}sanitizerResourceUrl(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)}updatePreviewImageTransform(){this.previewImageTransform=`scale3d(${this.zoom*(this.flipHorizontally?-1:1)}, ${this.zoom*(this.flipVertically?-1:1)}, 1) rotate(${this.rotate}deg)`}updatePreviewImageWrapperTransform(){this.previewImageWrapperTransform=`translate3d(${this.position.x}px, ${this.position.y}px, 0)`}updateZoomOutDisabled(){this.zoomOutDisabled=this.zoom<=1}handlerImageTransformationWhileZoomingWithMouse(e,n){let i,o=this.imageRef.nativeElement,r=getComputedStyle(o).transform.match(/matrix.*\((.+)\)/);r?i=+r[1].split(", ")[0]:i=this.zoom;let v=(e.clientX-o.getBoundingClientRect().x)/i,x=(e.clientY-o.getBoundingClientRect().y)/i,y=n<0?this.scaleStep/2:-this.scaleStep/2;this.position.x+=-v*y*2+o.offsetWidth*y,this.position.y+=-x*y*2+o.offsetHeight*y}handleImageScaleWhileZoomingWithMouse(e){this.isZoomedInWithMouseWheel(e)?this.onZoomIn():this.onZoomOut(),this.zoom<=1&&this.reCenterImage()}isZoomedInWithMouseWheel(e){return e<0}reset(){this.zoom=this.config.nzZoom??this._defaultNzZoom,this.scaleStep=this.config.nzScaleStep??this._defaultNzScaleStep,this.rotate=this.config.nzRotate??this._defaultNzRotate,this.flipHorizontally=!1,this.flipVertically=!1,this.reCenterImage()}reCenterImage(){this.position=f({},Oe)}static{this.\u0275fac=function(n){return new(n||t)(c(ae),c(Y),c(O),c(E),c(Z),c(Ce))}}static{this.\u0275cmp=L({type:t,selectors:[["nz-image-preview"]],viewQuery:function(n,i){if(n&1&&(B(He,5),B($e,7)),n&2){let o;U(o=Q())&&(i.imageRef=o.first),U(o=Q())&&(i.imagePreviewWrapper=o.first)}},hostAttrs:[1,"ant-image-preview-root"],hostVars:6,hostBindings:function(n,i){n&1&&de("@fadeMotion.start",function(a){return i.onAnimationStart(a)})("@fadeMotion.done",function(a){return i.onAnimationDone(a)}),n&2&&(pe("@.disabled",i.config.nzNoAnimation)("@fadeMotion",i.visible?"enter":"leave"),M("z-index",i.config.nzZIndex),b("ant-image-preview-moving",i.isDragging))},exportAs:["nzImagePreview"],standalone:!0,features:[ze([Z]),K],decls:17,vars:5,consts:[["imagePreviewWrapper",""],["imgRef",""],[1,"ant-image-preview-mask"],[1,"ant-image-preview-operations-wrapper"],[1,"ant-image-preview-operations"],[1,"ant-image-preview-operations-progress"],[1,"ant-image-preview-operations-operation",3,"ant-image-preview-operations-operation-disabled"],["tabindex","-1",1,"ant-image-preview-wrap",3,"click"],["role","dialog","aria-modal","true",1,"ant-image-preview"],["tabindex","0","aria-hidden","true",1,"ant-image-preview-focus-trap"],[1,"ant-image-preview-content"],[1,"ant-image-preview-body"],["cdkDrag","",1,"ant-image-preview-img-wrapper",3,"cdkDragEnded","cdkDragFreeDragPosition"],[1,"ant-image-preview-switch-left",3,"click"],["nz-icon","","nzType","left","nzTheme","outline"],[1,"ant-image-preview-switch-right",3,"click"],["nz-icon","","nzType","right","nzTheme","outline"],[1,"ant-image-preview-operations-operation",3,"click"],["nz-icon","","nzTheme","outline",1,"ant-image-preview-operations-icon",3,"nzType","nzRotate"],["cdkDragHandle","",1,"ant-image-preview-img",3,"width","height","transform"],["cdkDragHandle","",1,"ant-image-preview-img"]],template:function(n,i){if(n&1){let o=F();g(0,"div",2),l(1,"div",3),T(2,Ve,4,4),l(3,"ul",4),T(4,je,2,2,"li",5),j(5,Ge,2,4,"li",6,V),d()(),l(7,"div",7),u("click",function(r){return z(o),w(i.maskClosable&&r.target===r.currentTarget&&i.onClose())}),l(8,"div",8),g(9,"div",9),l(10,"div",10)(11,"div",11)(12,"div",12,0),u("cdkDragEnded",function(r){return z(o),w(i.onDragEnd(r))}),j(14,Ue,1,1,null,null,V),d()()(),g(16,"div",9),d()()}n&2&&(m(2),R(i.images.length>1?2:-1),m(2),R(i.images.length>1?4:-1),m(),G(i.operations),m(7),M("transform",i.previewImageWrapperTransform),$("cdkDragFreeDragPosition",i.position),m(2),G(i.images))},dependencies:[_e,Se,xe,Ne],encapsulation:2,data:{animation:[Ee]},changeDetection:0})}}return t})(),J=class{constructor(s,e,n){this.previewInstance=s,this.config=e,this.overlayRef=n,this.destroy$=new S,n.keydownEvents().pipe(A(i=>this.config.nzKeyboard&&(i.keyCode===27||i.keyCode===37||i.keyCode===39)&&!ke(i))).subscribe(i=>{i.preventDefault(),i.keyCode===27&&s.onClose(),i.keyCode===37&&this.prev(),i.keyCode===39&&this.next()}),n.detachments().subscribe(()=>{this.overlayRef.dispose()}),s.closeClick.pipe(ee(1),te(()=>s.animationStateChanged),A(i=>i.phaseName==="done"),h(this.destroy$)).subscribe(()=>{this.close()})}switchTo(s){this.previewInstance.switchTo(s)}next(){this.previewInstance.next()}prev(){this.previewInstance.prev()}close(){this.destroy$.next(),this.overlayRef.dispose()}},We=(()=>{class t{constructor(e,n,i,o){this.overlay=e,this.injector=n,this.nzConfigService=i,this.directionality=o}preview(e,n,i){return this.display(e,n,i)}display(e,n,i){let o=f(f({},new E),n??{}),a=this.createOverlay(o),r=this.attachPreviewComponent(a,o);r.setImages(e,i);let v=new J(r,o,a);return r.previewRef=v,v}attachPreviewComponent(e,n){let i=N.create({parent:this.injector,providers:[{provide:De,useValue:e},{provide:E,useValue:n}]}),o=new Ie(Ae,null,i);return e.attach(o).instance}createOverlay(e){let n=this.nzConfigService.getConfigForComponent(Ze)||{},i=new be({scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:e.nzCloseOnNavigation??n.nzCloseOnNavigation??!0,direction:e.nzDirection||n.nzDirection||this.directionality.value});return this.overlay.create(i)}static{this.\u0275fac=function(n){return new(n||t)(k(Pe),k(N),k(O),k(q))}}static{this.\u0275prov=ie({token:t,factory:t.\u0275fac})}}return t})(),et="image",xt=(()=>{class t{get previewable(){return!this.nzDisablePreview&&this.status!=="error"}constructor(e,n,i,o,a){this.nzConfigService=e,this.elementRef=n,this.nzImageService=i,this.cdr=o,this.directionality=a,this._nzModuleName=et,this.nzSrc="",this.nzSrcset="",this.nzDisablePreview=!1,this.nzFallback=null,this.nzPlaceholder=null,this.nzScaleStep=null,this.status="normal",this.backLoadDestroy$=new S,this.destroy$=new S,this.document=W(ye),this.parentGroup=W(Qe,{optional:!0})}ngOnInit(){this.backLoad(),this.parentGroup&&this.parentGroup.addImage(this),this.directionality&&(this.directionality.change?.pipe(h(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreview(){if(this.previewable)if(this.parentGroup){let e=this.parentGroup.images.filter(r=>r.previewable),n=e.map(r=>({src:r.nzSrc,srcset:r.nzSrcset})),i=e.findIndex(r=>this===r),o=new Map;e.forEach(r=>{o.set(r.nzSrc??r.nzSrcset,r.nzScaleStep??this.parentGroup.nzScaleStep??this.nzScaleStep??X)}),this.nzImageService.preview(n,{nzDirection:this.dir},o).switchTo(i)}else{let e=[{src:this.nzSrc,srcset:this.nzSrcset}];this.nzImageService.preview(e,{nzDirection:this.dir,nzScaleStep:this.nzScaleStep??X})}}getElement(){return this.elementRef}ngOnChanges(e){let{nzSrc:n}=e;n&&(this.getElement().nativeElement.src=n.currentValue,this.backLoad())}backLoad(){this.backLoadImage=this.document.createElement("img"),this.backLoadImage.src=this.nzSrc,this.backLoadImage.srcset=this.nzSrcset,this.status="loading",this.backLoadDestroy$.next(),this.backLoadDestroy$.complete(),this.backLoadDestroy$=new S,this.backLoadImage.complete?(this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset):(this.nzPlaceholder?(this.getElement().nativeElement.src=this.nzPlaceholder,this.getElement().nativeElement.srcset=""):(this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset),I(this.backLoadImage,"load").pipe(h(this.backLoadDestroy$),h(this.destroy$)).subscribe(()=>{this.status="normal",this.getElement().nativeElement.src=this.nzSrc,this.getElement().nativeElement.srcset=this.nzSrcset}),I(this.backLoadImage,"error").pipe(h(this.backLoadDestroy$),h(this.destroy$)).subscribe(()=>{this.status="error",this.nzFallback&&(this.getElement().nativeElement.src=this.nzFallback,this.getElement().nativeElement.srcset="")}))}static{this.\u0275fac=function(n){return new(n||t)(c(O),c(ce),c(We),c(Y),c(q))}}static{this.\u0275dir=se({type:t,selectors:[["img","nz-image",""]],hostBindings:function(n,i){n&1&&u("click",function(){return i.onPreview()})},inputs:{nzSrc:"nzSrc",nzSrcset:"nzSrcset",nzDisablePreview:[2,"nzDisablePreview","nzDisablePreview",we],nzFallback:"nzFallback",nzPlaceholder:"nzPlaceholder",nzScaleStep:"nzScaleStep"},exportAs:["nzImage"],standalone:!0,features:[he,re]})}}return _([P()],t.prototype,"nzDisablePreview",void 0),_([P()],t.prototype,"nzFallback",void 0),_([P()],t.prototype,"nzPlaceholder",void 0),_([P()],t.prototype,"nzScaleStep",void 0),t})(),Nt=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=oe({type:t})}static{this.\u0275inj=ne({providers:[We],imports:[Ae]})}}return t})();export{We as a,xt as b,Nt as c};
