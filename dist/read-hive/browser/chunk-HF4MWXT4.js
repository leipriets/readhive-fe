import{a as Re,c as Ue,d as $e,e as We,f as je,h as Ve,i as Be,j as qe}from"./chunk-WWSAG6DA.js";import{b as we}from"./chunk-ABHDLS6S.js";import{a as Ht,d as Ke,e as Qe,f as Ye,g as Ge,h as Xe,i as Ze}from"./chunk-LAJZP7FY.js";import{a as Z}from"./chunk-NU526JQJ.js";import{a as Lt,c as Ie,h as Fe,j as vt,k as Ct,l as St,m as W,n as j,o as He,p as wt}from"./chunk-JPE7QZ5X.js";import{a as _t,b as zt,f as xt}from"./chunk-ZPB5WU26.js";import{b as De,c as ut,f as Ee}from"./chunk-2ZQ6Y2I4.js";import{a as Me,b as ht,e as Ae,f as Oe,g as Pe,h as Le,i as yt}from"./chunk-RUYDGNTY.js";import{r as be,s as ke}from"./chunk-S6VRG45Q.js";import{a as Je,b as ti,c as ei}from"./chunk-BV66YZ3D.js";import{f as Tt}from"./chunk-TAL2UZFE.js";import{n as Ne,o as gt}from"./chunk-NNJUV6AO.js";import{a as ct,b as pt,c as mt}from"./chunk-T53K6S7Z.js";import{U as G}from"./chunk-X5J5AAS6.js";import{$ as Y,Ka as st,L as Pt,La as Se,Nb as dt,Ob as ye,Pb as xe,Rb as ft,Sb as X,_ as ze,aa as ve,ab as Te,ca as Ce,fa as lt,ga as $,j as ue,m as he,o as ge,p as _e}from"./chunk-W7R43Y2J.js";import{$b as P,A as J,Ac as b,Bc as U,Cc as oe,Db as Jt,Dc as x,E as tt,Gb as g,Ha as A,Ia as D,Ja as M,Kb as p,L as Nt,Mb as te,Mc as re,Pc as Ot,Qc as ae,Ra as I,Sa as nt,Sb as T,Tb as ee,Va as It,Vb as Ft,Wb as Et,Xb as l,Yb as s,Yc as le,Zb as m,_b as O,a as qt,bc as F,dc as w,ea as Gt,f as Kt,fc as d,ga as Q,gc as ie,ha as et,hc as ne,hd as se,id as ce,jd as rt,kc as L,kd as pe,lb as ot,lc as H,ld as me,m as K,ma as bt,mc as R,md as at,nc as y,nd as de,oc as f,od as fe,p as Qt,pb as a,pc as N,qb as h,qc as C,qd as k,ra as it,u as Dt,v as Mt,w as Yt,wa as z,wb as Zt,wc as v,xa as kt,xc as At,ya as Xt,yc as E}from"./chunk-SSCO7BOT.js";import{a as q,b as Bt}from"./chunk-GAL4ENT6.js";var gi=["ink"],_i=["*"],zi=t=>({"ant-anchor-wrapper-horizontal":t}),vi=t=>({"ant-anchor-fixed":t});function Ci(t,i){}function Si(t,i){if(t&1&&(l(0,"nz-affix",2),g(1,Ci,0,0,"ng-template",3),s()),t&2){let e=d(),n=y(3);p("nzOffsetTop",e.nzOffsetTop)("nzTarget",e.container),a(),p("ngTemplateOutlet",n)}}function Ti(t,i){}function yi(t,i){if(t&1&&g(0,Ti,0,0,"ng-template",3),t&2){d();let e=y(3);p("ngTemplateOutlet",e)}}function xi(t,i){if(t&1&&(l(0,"div",4)(1,"div",5)(2,"div",6),m(3,"div",7,1),s(),ne(5),s()()),t&2){let e=d();p("ngClass",E(3,zi,e.nzDirection==="horizontal"))("ngStyle",e.wrapperStyle),a(),p("ngClass",E(5,vi,!e.nzAffix&&!e.nzShowInkInFixed))}}function ii(t,i){if(!t||!t.getClientRects().length)return 0;let e=t.getBoundingClientRect();if(e.width||e.height){if(i===window){let n=t.ownerDocument.documentElement;return e.top-n.clientTop}return e.top-i.getBoundingClientRect().top}return e.top}var ni="ant-anchor-ink-ball-visible",wi="anchor",Di=/#([^#]+)$/,Mi=Ce({passive:!0}),Ni=(()=>{class t{constructor(e,n,o,r,c,u){this.nzConfigService=e,this.scrollSrv=n,this.cdr=o,this.platform=r,this.zone=c,this.renderer=u,this._nzModuleName=wi,this.nzAffix=!0,this.nzShowInkInFixed=!1,this.nzBounds=5,this.nzOffsetTop=void 0,this.nzTargetOffset=void 0,this.nzDirection="vertical",this.nzClick=new I,this.nzChange=new I,this.nzScroll=new I,this.visible=!1,this.wrapperStyle={"max-height":"100vh"},this.links=[],this.animating=!1,this.destroy$=new Kt,this.doc=it(le)}registerLink(e){this.links.push(e)}unregisterLink(e){this.links.splice(this.links.indexOf(e),1)}getContainer(){return this.container||window}ngAfterViewInit(){this.registerScrollEvent()}ngOnDestroy(){clearTimeout(this.handleScrollTimeoutID),this.destroy$.next(!0),this.destroy$.complete()}registerScrollEvent(){this.platform.isBrowser&&(this.destroy$.next(!0),this.zone.runOutsideAngular(()=>{J(this.getContainer(),"scroll",Mi).pipe(et(50),Gt(this.destroy$)).subscribe(()=>this.handleScroll())}),this.handleScrollTimeoutID=setTimeout(()=>this.handleScroll()))}handleScroll(){if(typeof document>"u"||this.animating)return;let e=[],o=(this.nzTargetOffset?this.nzTargetOffset:this.nzOffsetTop||0)+this.nzBounds;if(this.links.forEach(r=>{let c=Di.exec(r.nzHref.toString());if(!c)return;let u=this.doc.getElementById(c[1]);if(u){let _=ii(u,this.getContainer());_<o&&e.push({top:_,comp:r})}}),this.visible=!!e.length,!this.visible)this.clearActive(),this.cdr.detectChanges();else{let r=e.reduce((c,u)=>u.top>c.top?u:c);this.handleActive(r.comp)}this.setVisible()}clearActive(){this.links.forEach(e=>{e.unsetActive()})}setActive(e){let n=this.activeLink,o=this.nzCurrentAnchor&&this.links.find(c=>c.nzHref===this.nzCurrentAnchor)||e;if(!o)return;o.setActive();let r=o.getLinkTitleElement();this.nzDirection==="vertical"?this.ink.nativeElement.style.top=`${r.offsetTop+r.clientHeight/2-4.5}px`:this.ink.nativeElement.style.left=`${r.offsetLeft+r.clientWidth/2}px`,this.activeLink=(e||o).nzHref,n!==this.activeLink&&this.nzChange.emit(this.activeLink)}handleActive(e){this.clearActive(),this.setActive(e),this.visible=!0,this.setVisible(),this.nzScroll.emit(e)}setVisible(){this.ink&&(this.visible?this.renderer.addClass(this.ink.nativeElement,ni):this.renderer.removeClass(this.ink.nativeElement,ni))}handleScrollTo(e){let n=this.doc.querySelector(e.nzHref);if(!n)return;this.animating=!0;let o=this.scrollSrv.getScroll(this.getContainer()),r=ii(n,this.getContainer()),c=o+r;c-=this.nzTargetOffset!==void 0?this.nzTargetOffset:this.nzOffsetTop||0,this.scrollSrv.scrollTo(this.getContainer(),c,{callback:()=>{this.animating=!1,this.handleActive(e)}}),this.nzClick.emit(e.nzHref)}ngOnChanges(e){let{nzOffsetTop:n,nzContainer:o,nzCurrentAnchor:r}=e;if(n&&(this.wrapperStyle={"max-height":`calc(100vh - ${this.nzOffsetTop}px)`}),o){let c=this.nzContainer;this.container=typeof c=="string"?this.doc.querySelector(c):c,this.registerScrollEvent()}r&&this.setActive()}static{this.\u0275fac=function(n){return new(n||t)(h(ze),h(Te),h(re),h(ve),h(nt),h(Zt))}}static{this.\u0275cmp=z({type:t,selectors:[["nz-anchor"]],viewQuery:function(n,o){if(n&1&&L(gi,5),n&2){let r;H(r=R())&&(o.ink=r.first)}},inputs:{nzAffix:[2,"nzAffix","nzAffix",Ot],nzShowInkInFixed:[2,"nzShowInkInFixed","nzShowInkInFixed",Ot],nzBounds:[2,"nzBounds","nzBounds",ae],nzOffsetTop:[2,"nzOffsetTop","nzOffsetTop",Pt],nzTargetOffset:[2,"nzTargetOffset","nzTargetOffset",Pt],nzContainer:"nzContainer",nzCurrentAnchor:"nzCurrentAnchor",nzDirection:"nzDirection"},outputs:{nzClick:"nzClick",nzChange:"nzChange",nzScroll:"nzScroll"},exportAs:["nzAnchor"],standalone:!0,features:[Jt,A,v],ngContentSelectors:_i,decls:4,vars:1,consts:[["content",""],["ink",""],[3,"nzOffsetTop","nzTarget"],[3,"ngTemplateOutlet"],[1,"ant-anchor-wrapper",3,"ngClass","ngStyle"],[1,"ant-anchor",3,"ngClass"],[1,"ant-anchor-ink"],[1,"ant-anchor-ink-ball"]],template:function(n,o){n&1&&(ie(),g(0,Si,2,3,"nz-affix",2)(1,yi,1,1,null,3)(2,xi,6,7,"ng-template",null,0,x)),n&2&&T(o.nzAffix?0:1)},dependencies:[se,pe,me,ut,De],encapsulation:2,changeDetection:0})}}return K([Y()],t.prototype,"nzShowInkInFixed",void 0),K([Y()],t.prototype,"nzBounds",void 0),K([Y()],t.prototype,"nzOffsetTop",void 0),K([Y()],t.prototype,"nzTargetOffset",void 0),t})();var oi=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=kt({type:t})}static{this.\u0275inj=bt({imports:[Ni]})}}return t})();var ri=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=z({type:t,selectors:[["app-skeleton"]],standalone:!0,features:[v],decls:2,vars:0,template:function(n,o){n&1&&m(0,"nz-skeleton")(1,"nz-skeleton")},dependencies:[Oe,Ae],encapsulation:2})}}return t})();function bi(t,i,e,n){let o=window&&!!window.document&&window.document.documentElement,r=o&&i?window:e;if(t&&(r=t&&o&&typeof t=="string"?ki(t,e.nativeElement,n):t,!r))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return r}function ki(t,i,e){return(e?window.document:i).querySelector(t)}function Rt(t){return t&&!t.firstChange}function Ii(){return typeof window<"u"}var Fi={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},Ei={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},Ut=class{constructor(i=!0){this.vertical=i,this.propsMap=i?Fi:Ei}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function Ai(t,i,e){return!!(t&&i||!e&&i)}function Oi({windowElement:t,axis:i}){return Pi({axis:i,isWindow:Li(t)},t)}function Pi(t,i){let e=t.isWindow||i&&!i.nativeElement?i:i.nativeElement;return Bt(q({},t),{container:e})}function Li(t){return["Window","global"].some(e=>Object.prototype.toString.call(t).includes(e))}function jt(t,i){return t?i.document.documentElement:null}function ai(t,i){let e=Ui(i);return i.isWindow?Hi(e,t,i):Ri(e,t,i)}function Hi(t,i,e){let{axis:n,container:o,isWindow:r}=e,{offsetHeightKey:c,clientHeightKey:u}=li(n),_=t+ci(jt(r,o),n,r),S=si(i.nativeElement,r,c,u),B=$i(i.nativeElement,n,r)+S;return{height:t,scrolled:_,totalToScroll:B,isWindow:r}}function Ri(t,i,e){let{axis:n,container:o}=e,r=o[n.scrollTopKey()],c=o[n.scrollHeightKey()];return{height:t,scrolled:r,totalToScroll:c,isWindow:!1}}function li(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function Ui({container:t,isWindow:i,axis:e}){let{offsetHeightKey:n,clientHeightKey:o}=li(e);return si(t,i,n,o)}function si(t,i,e,n){if(isNaN(t[e])){let o=jt(i,t);return o?o[n]:0}else return t[e]}function $i(t,i,e){let n=i.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[n]+ci(t,i,e)}function ci(t,i,e){let n=i.pageYOffsetKey(),o=i.scrollTopKey(),r=i.offsetTopKey();return isNaN(window.pageYOffset)?jt(e,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[n]:t[r]}function Wi(t,i={down:0,up:0},e){let n,o;if(t.totalToScroll<=0)return!1;let r=t.isWindow?t.scrolled:t.height+t.scrolled;if(e)n=(t.totalToScroll-r)/t.totalToScroll,o=(i?.down?i.down:0)/10;else{let u=t.scrolled+(t.totalToScroll-r);n=t.scrolled/u,o=(i?.up?i.up:0)/10}return n<=o}function ji(t,i){return t<i.scrolled}function Vi(t,i,e){let n=ji(t,i);return{fire:Wi(i,e,n),scrollDown:n}}var $t=class{constructor(i){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,i)}updateScrollPosition(i){return this.lastScrollPosition=i}updateTotalToScroll(i){this.lastTotalToScroll!==i&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=i)}updateScroll(i,e){this.updateScrollPosition(i),this.updateTotalToScroll(e)}updateTriggeredFlag(i,e){e?this.triggered.down=i:this.triggered.up=i}isTriggeredScroll(i,e){return e?this.triggered.down===i:this.triggered.up===i}};function Bi(t){let{scrollContainer:i,scrollWindow:e,element:n,fromRoot:o}=t,r=Oi({axis:new Ut(!t.horizontal),windowElement:bi(i,e,n,o)}),c=new $t({totalToScroll:ai(n,r).totalToScroll}),u={container:r.container,throttle:t.throttle},_={up:t.upDistance,down:t.downDistance};return qi(u).pipe(Yt(()=>Qt(ai(n,r))),Dt(S=>Ki(c.lastScrollPosition,S,_)),Q(({stats:S})=>c.updateScroll(S.scrolled,S.totalToScroll)),tt(({fire:S,scrollDown:B,stats:{totalToScroll:hi}})=>Ai(t.alwaysCallback,S,c.isTriggeredScroll(hi,B))),Q(({scrollDown:S,stats:{totalToScroll:B}})=>{c.updateTriggeredFlag(B,S)}),Dt(Qi))}function qi(t){let i=J(t.container,"scroll");return t.throttle&&(i=i.pipe(et(t.throttle,void 0,{leading:!0,trailing:!0}))),i}function Ki(t,i,e){let{scrollDown:n,fire:o}=Vi(t,i,e);return{scrollDown:n,fire:o,stats:i}}var Wt={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function Qi(t){let{scrollDown:i,stats:{scrolled:e}}=t;return{type:i?Wt.DOWN:Wt.UP,payload:{currentScrollPosition:e}}}var pi=(()=>{class t{constructor(e,n){this.element=e,this.zone=n,this.scrolled=new I,this.scrolledUp=new I,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:e,infiniteScrollDisabled:n,infiniteScrollDistance:o}){let r=Rt(e),c=Rt(n),u=Rt(o),_=!c&&!this.infiniteScrollDisabled||c&&!n.currentValue||u;(r||c||u)&&(this.destroyScroller(),_&&this.setup())}ngOnDestroy(){this.destroyScroller()}setup(){Ii()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=Bi({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(e=>this.handleOnScroll(e))})}handleOnScroll({type:e,payload:n}){let o=e===Wt.DOWN?this.scrolled:this.scrolledUp;Yi(o)&&this.zone.run(()=>o.emit(n))}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}static{this.\u0275fac=function(n){return new(n||t)(h(It),h(nt))}}static{this.\u0275dir=Xt({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},standalone:!0,features:[A]})}}return t})();function Yi(t){return t.observed??t.observers.length>0}function Ji(t,i){if(t&1&&(O(0,11),l(1,"nz-tag",12),f(2),s(),P()),t&2){let e=i.$implicit;a(),p("nzColor","blue"),a(),C("#",e,"")}}var di=(()=>{class t{constructor(){this.nzModalData=it(be),this.pathUrl=X.apiPath,this.avatarUrl=""}ngOnInit(){this.avatarUrl=this.nzModalData.articleData.author.image}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=z({type:t,selectors:[["app-article-slug-modal"]],standalone:!0,features:[v],decls:31,vars:12,consts:[["nz-row",""],["nz-col","","nzSpan","20"],[1,"content"],["nz-typography",""],["nz-typography","","nzType","secondary"],["nz-col","","nzSpan","24"],[3,"innerHTML"],["ngFor","",4,"ngFor","ngForOf"],[1,"content-link"],[3,"isFavorited","articleSlug","favoritesCount"],[3,"articleId","slug","isDirectComment"],["ngFor",""],[3,"nzColor"]],template:function(n,o){n&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),f(4),b(5,"titlecase"),s(),l(6,"span",4)(7,"strong")(8,"i"),f(9,"About:"),s(),f(10," \xA0"),s(),f(11),s()()()(),l(12,"div",0)(13,"div",5),m(14,"nz-divider"),s()(),l(15,"div",0)(16,"div",5)(17,"div",2),m(18,"div",6),s()()(),l(19,"div",0)(20,"div",1),m(21,"br"),g(22,Ji,3,2,"ng-container",7),s()(),l(23,"div",0)(24,"div",1),m(25,"nz-divider"),s()(),l(26,"div")(27,"div",1)(28,"div",8),m(29,"app-add-to-favorites",9),s()()(),m(30,"app-comment",10)),n&2&&(a(4),N(U(5,10,o.nzModalData.articleData.title)),a(7),N(o.nzModalData.articleData.description),a(7),p("innerHTML",o.nzModalData.articleData.body,ot),a(4),p("ngForOf",o.nzModalData.articleData==null?null:o.nzModalData.articleData.tagList),a(7),p("isFavorited",o.nzModalData.articleData.favorited)("articleSlug",o.nzModalData.articleData.slug)("favoritesCount",o.nzModalData.articleData.favoritesCount),a(),p("articleId",o.nzModalData.articleData.id)("slug",o.nzModalData.articleData.slug)("isDirectComment",o.nzModalData.isDirectComment))},dependencies:[k,ce,de,j,W,Ee,zt,_t,vt,ht,St,Ct,mt,pt,ct,yt,Tt,$,wt,He]})}}return t})();var fi=(()=>{class t{constructor(){this.timeDiff=""}ngOnInit(){this.timeDiff=this.getTimeDiff(this.createdDate)}getTimeDiff(e){return xt(e)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=z({type:t,selectors:[["app-tooltip-date"]],inputs:{createdDate:"createdDate"},standalone:!0,features:[v],decls:4,vars:5,consts:[["nzTooltipPlacement","bottom","nz-tooltip","",3,"nzTooltipTitle"],["nz-typography","","nzType","secondary",2,"font-size","12px","font-weight","italic"]],template:function(n,o){n&1&&(l(0,"a",0),b(1,"date"),l(2,"span",1),f(3),s()()),n&2&&(p("nzTooltipTitle",oe(1,2,o.createdDate,"medium")),a(3),C(" ",o.timeDiff," "))},dependencies:[k,fe,j,W,gt,Ne]})}}return t})();function on(t,i){t&1&&(l(0,"span"),f(1,"\xA0"),l(2,"b"),f(3,"New Post"),s()())}function rn(t,i){if(t&1){let e=F();O(0),l(1,"button",3),w("click",function(){D(e);let o=d();return M(o.CreateArticleFormDrawer())}),l(2,"i"),m(3,"span",4),g(4,on,4,0,"span",0),s()(),P()}if(t&2){let e=d();a(4),p("ngIf",!e.isCollapsed)}}var ui=(()=>{class t{constructor(e){this.store=e,this.currentUser$=this.store.select(G)}CreateArticleFormDrawer(){this.drawerTemplate.openDrawer()}static{this.\u0275fac=function(n){return new(n||t)(h(st))}}static{this.\u0275cmp=z({type:t,selectors:[["app-new-post"]],viewQuery:function(n,o){if(n&1&&L(Lt,5),n&2){let r;H(r=R())&&(o.drawerTemplate=r.first)}},inputs:{isCollapsed:"isCollapsed"},standalone:!0,features:[v],decls:5,vars:4,consts:[[4,"ngIf"],[3,"title"],["content",""],["nz-button","","nzSize","default","nzType","primary",3,"click"],["nz-icon","","nzType","edit"]],template:function(n,o){n&1&&(g(0,rn,5,1,"ng-container",0),b(1,"async"),l(2,"app-drawer",1),m(3,"create-article",2),f(4,`>
`),s()),n&2&&(p("ngIf",U(1,2,o.currentUser$)),a(2),p("title","Create Article"))},dependencies:[k,rt,at,ft,xe,dt,ye,$,lt,Lt,Ie],styles:[".mt-20[_ngcontent-%COMP%]{margin-top:10px}.right10[_ngcontent-%COMP%]{margin-right:10px}"]})}}return t})();var an=["divArticleContent"],ln=(t,i)=>i.id,sn=t=>["/profile",t],cn=()=>({tab:"posts"}),pn=t=>["/tags",t],mn=t=>["/articles",t],dn=()=>["/sp/login"];function fn(t,i){t&1&&(l(0,"span"),f(1,"For You"),s())}function un(t,i){t&1&&(l(0,"span"),f(1,"Following"),s())}function hn(t,i){if(t&1&&(l(0,"span"),f(1),s()),t&2){let e=d();a(),C("#",e.queryParams.tab,"")}}function gn(t,i){if(t&1&&(l(0,"strong")(1,"a",27),f(2),s()()),t&2){let e=d(2).$implicit;a(),p("routerLink",E(3,sn,e.author.username))("queryParams",At(5,cn)),a(),N(e.author.username)}}function _n(t,i){if(t&1&&(l(0,"strong")(1,"a",28),f(2),s()()),t&2){let e=d(2).$implicit;a(2),N(e.author.username)}}function zn(t,i){if(t&1&&(l(0,"a",25)(1,"nz-tag",30),m(2,"span",31),f(3),s()()),t&2){let e=d().$implicit;p("routerLink",E(2,pn,e)),a(3),C(" ",e,"")}}function vn(t,i){if(t&1&&g(0,zn,4,4,"a",29),t&2){let e=i.$implicit;p("ngIf",e)}}function Cn(t,i){if(t&1&&(l(0,"div",10)(1,"div",23),g(2,gn,3,6,"strong")(3,_n,3,1,"strong"),s(),l(4,"div",24),Ft(5,vn,1,1,"a",25,ee),s()(),l(7,"div",10),m(8,"app-tooltip-date",26),s()),t&2){let e=d().$implicit,n=d(2).ngIf;a(2),T(n.currentUser?2:-1),a(),T(n.currentUser?-1:3),a(2),Et(e.tagList),a(3),p("createdDate",e.createdAt)}}function Sn(t,i){if(t&1&&m(0,"nz-avatar",32),t&2){let e=d().$implicit;p("nzSrc",e.author.image)}}function Tn(t,i){if(t&1&&(l(0,"a",25),f(1),s()),t&2){let e=d(2).$implicit;p("routerLink",E(2,mn,e.slug)),a(),C(" ",e.title," ")}}function yn(t,i){if(t&1){let e=F();l(0,"a",19),w("click",function(){D(e);let o=d(2).$implicit,r=y(29),c=d(3);return M(c.showArticleModal(o,r))}),f(1),s()}if(t&2){let e=d(2).$implicit;a(),C(" ",e.title," ")}}function xn(t,i){if(t&1&&g(0,Tn,2,4,"a",25)(1,yn,2,1,"a"),t&2){let e=d(4);T(e.isProfileTab?0:-1),a(),T(e.isProfileTab?-1:1)}}function wn(t,i){if(t&1&&m(0,"app-add-to-favorites",21),t&2){let e=d().$implicit;p("isFavorited",e.favorited)("articleSlug",e.slug)("favoritesCount",e.favoritesCount)}}function Dn(t,i){if(t&1){let e=F();l(0,"a",19),w("click",function(){D(e);let o=d().$implicit,r=y(29),c=d(3);return M(c.showArticleModal(o,r,!0))}),m(1,"span",22),s()}}function Mn(t,i){if(t&1&&(l(0,"nz-list-item-meta-avatar")(1,"a",25),m(2,"nz-avatar",32),s()()),t&2){let e=d().$implicit;a(),p("routerLink",At(2,dn)),a(),p("nzSrc",e.author.image)}}function Nn(t,i){if(t&1&&(l(0,"div",10)(1,"div",33),m(2,"nz-avatar",34),f(3," \xA0 "),l(4,"span",35),f(5),s()(),l(6,"div",23),m(7,"app-tooltip-date",26),s()()),t&2){let e=d().$implicit;a(),p("nzSpan",18),a(),p("nzSrc",e.author.image),a(3),N(e.author.username),a(2),p("createdDate",e.createdAt)}}function bn(t,i){if(t&1){let e=F();l(0,"nz-card"),m(1,"nz-card-meta",16),l(2,"div",17,0),m(4,"br")(5,"div",18),s(),l(6,"a",19),w("click",function(){let o=D(e).$implicit,r=d(3);return M(r.toggleCollapse(o.id))}),f(7),s(),m(8,"nz-divider"),l(9,"ul",20)(10,"nz-list-item-action"),m(11,"app-add-to-favorites",21),s(),l(12,"nz-list-item-action")(13,"a",19),w("click",function(){let o=D(e).$implicit,r=y(29),c=d(3);return M(c.showArticleModal(o,r,!0))}),m(14,"span",22),f(15),s()()()(),g(16,Cn,9,3,"ng-template",null,1,x)(18,Sn,1,1,"ng-template",null,2,x)(20,xn,2,2,"ng-template",null,3,x)(22,wn,1,3,"ng-template",null,4,x)(24,Dn,2,0,"ng-template",null,5,x)(26,Mn,3,3,"ng-template",null,6,x)(28,Nn,8,4,"ng-template",null,7,x),m(30,"br")}if(t&2){let e=i.$implicit,n=y(17),o=y(19),r=y(21),c=d(3);a(),p("nzTitle",n)("nzDescription",r)("nzAvatar",o),a(),te("collapsed",c.collapsedMap[e.id]),a(3),p("innerHTML",e.body,ot),a(2),C(" ",c.collapsedMap[e.id]?"Read more":"Show less"," "),a(4),p("isFavorited",e.favorited)("articleSlug",e.slug)("favoritesCount",e.favoritesCount),a(4),C(" ",e.commentsCount==0?"":e.commentsCount," ")}}function kn(t,i){t&1&&m(0,"app-skeleton")}function In(t,i){t&1&&(O(0),l(1,"nz-list-item")(2,"nz-list-item-meta")(3,"nz-list-item-meta-title")(4,"span",36)(5,"i"),f(6,"No more data."),s()()()()(),P())}function Fn(t,i){if(t&1&&(l(0,"div"),Ft(1,bn,31,11,null,null,ln),g(3,kn,1,0,"app-skeleton",15)(4,In,7,0,"ng-container",15),m(5,"br"),s()),t&2){let e=d().ngIf;a(),Et(e.feed),a(2),p("ngIf",e.isLoading),a(),p("ngIf",e.isLastPage)}}function En(t,i){if(t&1&&(l(0,"nz-list",14),g(1,Fn,6,2,"div",15),s()),t&2){let e=i.ngIf;a(),p("ngIf",e.feed)}}var Rr=(()=>{class t{constructor(e,n,o,r,c){this.store=e,this.router=n,this.route=o,this.modalService=r,this.sanitizer=c,this.apiUrl="",this.subscription=new qt,this.collapsedMap={},this.data$=Mt({isLoading:this.store.select(Ke),error:this.store.select(Qe),feed:this.store.select(Ye),articlesCount:this.store.select(Ge),currentUser:this.store.select(G),isLastPage:this.store.select(Xe)}).pipe(Q(u=>{for(let _ of u.feed)_.id in this.collapsedMap||(this.collapsedMap[_.id]=!0,this.currentSessionUsername!==_.author.username&&(this.isProfileTab=!1))})),this.hasMore$=this.store.select(Ze),this.offset=0,this.limit=X.limit,this.baseUrl=this.router.url.split("?")[0],this.currentPage=1,this.pageSize=0,this.noArticles=!1,this.currentSessionId=null,this.currentSessionUsername=null,this.backendApi=`${X.apiPath}`,this.isProfileTab=!1,this.queryParams={},this.currentRoute="",this.currentRouteParam=null}ngOnInit(){this.setCurrentSession(),this.fetchFeed(),this.queryParams=this.route.snapshot.queryParams,this.queryParams.tab&&this.queryParams.tab.trim()!==""&&this.queryParams.tab=="posts"&&this.queryParams.tab!=="favorites"&&(this.isProfileTab=!0),this.currentRoute=this.router.url.split("?")[0],this.currentRouteParam=this.route.snapshot.paramMap.get("slug")}ngOnChanges(e){if(e.apiUrl&&!e.apiUrl.firstChange){this.setCurrentSession();let n=e.apiUrl.currentValue,o=Z.parseUrl(n),r=Z.stringify(q({userId:this.currentSessionId,limit:this.limit,offset:0},o.query)),c=`${o.url}?${r}`;this.store.dispatch(Ht.getFeed({url:c}))}this.queryParams=this.route.snapshot.queryParams}fetchFeed(){let e=Z.parseUrl(this.apiUrl),n=Z.stringify(q({userId:this.currentSessionId,limit:this.limit,offset:this.offset},e.query)),o=`${e.url}?${n}`,r=this.data$.subscribe(c=>{this.pageSize=c.articlesCount});this.store.dispatch(Ht.getFeed({url:o})),this.pageSize>=this.offset&&(this.offset+=this.limit),this.subscription.add(r)}onScroll(){setTimeout(()=>{Mt([this.hasMore$]).pipe(Nt(1)).subscribe(([e])=>{e&&this.fetchFeed()})},1e3)}setCurrentSession(){this.currentUserSubscription=this.store.pipe(Se(G),tt(Boolean),Nt(1)).subscribe(e=>{this.currentSessionId=e.id,this.currentSessionUsername=e.username})}showArticleModal(e,n,o){this.safeContent=this.sanitizer.bypassSecurityTrustHtml(e.body);let r=this.modalService.create({nzTitle:n,nzContent:di,nzWidth:"1000px",nzStyle:{top:"20px"},nzData:{articleData:e,articleBody:this.safeContent,articleUsername:e?.author.username,articleAvatar:e?.author?.image,isDirectComment:o},nzFooter:[{label:"Close",shape:"round",onClick:()=>r.destroy()}]})}toggleCollapse(e){this.collapsedMap[e]=!this.collapsedMap[e]}getTimeDiff(e){return xt(e)}ngOnDestroy(){this.subscription.unsubscribe(),this.currentUserSubscription?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||t)(h(st),h(ge),h(he),h(ke),h(ue))}}static{this.\u0275cmp=z({type:t,selectors:[["app-feed"]],viewQuery:function(n,o){if(n&1&&L(an,5),n&2){let r;H(r=R())&&(o.divArticleContent=r.first)}},inputs:{apiUrl:"apiUrl"},standalone:!0,features:[A,v],decls:15,vars:11,consts:[["divArticleContent",""],["username",""],["avatarTemplate",""],["articleTitle",""],["favoritedSetting",""],["commentSetting",""],["redirectToLoginUsername",""],["userAvatarModal",""],["nz-icon","","nzType","home"],["infiniteScroll","",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle"],["nz-row",""],["nz-col","",3,"nzXs","nzSm","nzSpan"],["nzItemLayout","vertical",4,"ngIf"],[1,"lg:hidden","fixed","bottom-0","right-5","m-4"],["nzItemLayout","vertical"],[4,"ngIf"],[3,"nzTitle","nzDescription","nzAvatar"],[1,"rich-text-container","quill-content"],[3,"innerHTML"],[3,"click"],["nz-list-item-actions",""],[3,"isFavorited","articleSlug","favoritesCount"],["nz-icon","","nzType","comment"],["nz-col",""],["nz-col","","nzOffset","1"],[3,"routerLink"],[3,"createdDate"],[2,"color","black !important",3,"routerLink","queryParams"],["routerLink","/sp/login",2,"color","black !important"],[3,"routerLink",4,"ngIf"],["nzColor","blue"],["nz-icon","","nzType","borderless-table"],["nzIcon","user",3,"nzSrc"],["nz-col","",3,"nzSpan"],["nz-page-header-avatar","","nzIcon","user",3,"nzSrc"],["nz-typography","","nzType","secondary"],["nz-typography","","nzType","danger"]],template:function(n,o){n&1&&(l(0,"nz-breadcrumb")(1,"nz-breadcrumb-item"),m(2,"span",8),s(),l(3,"nz-breadcrumb-item"),g(4,fn,2,0,"span")(5,un,2,0,"span")(6,hn,2,1,"span"),s()(),m(7,"br"),l(8,"div",9),w("scrolled",function(){return o.onScroll()}),l(9,"div",10)(10,"div",11),g(11,En,2,1,"nz-list",12),b(12,"async"),s()()(),l(13,"div",13),m(14,"app-new-post"),s()),n&2&&(a(4),T(o.currentRoute=="/global-feed"?4:-1),a(),T(o.currentRoute=="/feed"?5:-1),a(),T(o.currentRouteParam?6:-1),a(2),p("infiniteScrollDistance",3)("infiniteScrollThrottle",1e3),a(2),p("nzXs",24)("nzSm",24)("nzSpan",24),a(),p("ngIf",U(12,9,o.data$)))},dependencies:[k,rt,at,_e,oi,zt,_t,qe,Ve,Be,$e,Re,Ue,je,We,$,lt,ft,dt,j,W,vt,Fe,St,Ct,ht,Me,yt,Le,Pe,mt,pt,ct,Tt,we,gt,ut,ei,ti,Je,wt,ri,fi,pi,ui],styles:['.font12[_ngcontent-%COMP%]{font-size:12px}.mr-8[_ngcontent-%COMP%]{margin-right:8px}.mr-10[_ngcontent-%COMP%]{margin-right:10rem}.date[_ngcontent-%COMP%]{color:#bbb;font-size:.8rem;display:block}a[_ngcontent-%COMP%]:hover{color:#1890ff}.mt-5[_ngcontent-%COMP%]{margin-top:5px}.photo-grid[_ngcontent-%COMP%]{margin-top:10px}.content-wrapper[_ngcontent-%COMP%]{max-width:70vh;max-height:70vh;overflow-x:auto;padding:1rem;word-break:break-word}.rich-text-container[_ngcontent-%COMP%]{max-height:none;overflow:hidden;max-width:110vh;overflow-x:auto;transition:max-height .3s ease}.rich-text-container.collapsed[_ngcontent-%COMP%]{max-height:100px;max-width:110vh;overflow-y:hidden;position:relative}.rich-text-container.collapsed[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:30px;background:linear-gradient(to bottom,transparent,white)}.quill-content[_ngcontent-%COMP%]{word-wrap:break-word;overflow-wrap:break-word;white-space:normal}']})}}return t})();export{ui as a,Rr as b};
