<ng-container *ngIf="data$ | async as data">
  <nz-page-header (nzBack)="onBack()" nzBackIcon>
    <!--avatar-->
    <nz-avatar
      [nzSrc]="data.article?.author?.image"
      nz-page-header-avatar
      nzIcon="user"
    ></nz-avatar>

    <!--subtitle-->
    <nz-page-header-subtitle>{{
      data.article?.author?.username
    }}</nz-page-header-subtitle>

    <!--tags-->
    <nz-page-header-tags ngFor="" *ngFor="let tag of data.article?.tagList">
      <nz-tag [nzColor]="'blue'">#{{ tag }}</nz-tag>
    </nz-page-header-tags>

    <!--extra-->
    <nz-page-header-extra>
      <nz-space *ngIf="data.article?.author?.username == currentUser?.username">
        <button
          *nzSpaceItem
          nz-button
          nzType="primary"
          (click)="openDrawerComponent()"
        >
          Edit Article
        </button>
        <button
          *nzSpaceItem
          nz-button
          nzType="primary"
          nzDanger
          (click)="deleteArticle()"
        >
          Delete Article
        </button>
        <button
          *nzSpaceItem
          nz-button
          nzNoAnimation
          nz-dropdown
          [nzDropdownMenu]="menu"
          nzPlacement="bottomRight"
          style="border: none; padding: 0"
        >
          <!-- <nz-icon nzType="more" nzTheme="outline" style="font-size: 20px; vertical-align: top;" /> -->
        </button>
      </nz-space>
      <nz-dropdown-menu #menu="nzDropdownMenu">
        <ul nz-menu>
          <li nz-menu-item>1st menu item length</li>
          <li nz-menu-item>2nd menu item length</li>
          <li nz-menu-item>3rd menu item length</li>
        </ul>
      </nz-dropdown-menu>
    </nz-page-header-extra>

    <!--content-->
    <nz-page-header-content>
      <div nz-row [nzGutter]="{xs: 8, sm: 16, md: 24, lg: 32}">
        @for (articleMedia of data.article?.article_media[0]?.files; track
        $index) {
        <div nz-col class="gutter-row" [nzSpan]="4.5">
          <nz-card nzHoverable style="width: 240px">
            <img
              nz-image
              width="200px"
              height="210vh"
              [nzSrc]="pathUrl + '/' + articleMedia?.filename"
              alt=""
            />
          </nz-card>
        </div>

        }
      </div>
      <div nz-row>
        <div nz-col nzSpan="18">
          <nz-divider></nz-divider>
        </div>
      </div>
      <div nz-row>
        <div nz-col nzSpan="18">
          <div class="content">
            <h4 nz-typography>{{ data.article?.title | titlecase }}</h4>
            <span nz-typography nzType="secondary">
              <strong><i>About:</i> &nbsp;</strong
              >{{ data.article?.description }}</span
            >
            <br /><br />
            <!-- <p
              nz-typography
              nz-paragraph
              nzEllipsis
              nzEllipsisRows="2"
              nzExpandable
              [nzContent]="data.article?.body"
            ></p> -->

            <!-- <div [innerHTML]="data.article?.body"></div> -->
            <div
              class="rich-text-container quill-content"
              #divArticleContent
              [class.collapsed]="isCollapse"
              *ngIf="safeContent$ | async as safeContent"
              [innerHTML]="safeContent"
            ></div>

            <a *ngIf="isViewReadMore" (click)="toggleCollapse()">
              {{ isCollapse ? 'Read more' : 'Show less' }}
            </a>

            <div class="content-link">
              <app-add-to-favorites
              [isFavorited]="data.article!.favorited"
              [articleSlug]="data.article!.slug"
              [favoritesCount]="data.article!.favoritesCount"
            ></app-add-to-favorites>

              <!-- <a>
                <span nz-icon nzType="heart"></span>&nbsp;{{
                  data.article?.favoritesCount
                }}
              </a> -->
            </div>
          </div>
        </div>
      </div>
    </nz-page-header-content>
  </nz-page-header>
  <app-comment [articleId]="data.article?.id" [slug]="slug"></app-comment>
</ng-container>

<ng-container>
  <app-drawer [title]="'Edit Article'">
    <app-edit-article content></app-edit-article>
  </app-drawer>
</ng-container>
