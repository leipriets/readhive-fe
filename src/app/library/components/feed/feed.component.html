<nz-list nzItemLayout="vertical" *ngIf="data$ | async as data">
  <app-skeleton *ngIf="data.isLoading"></app-skeleton>
  <div *ngIf="data.feed">
    @for (article of data.feed.articles; track article) {
    <nz-list-item>
      <nz-list-item-meta>
        <!-- <nz-list-item-meta-avatar
            nzSrc="https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"
          ></nz-list-item-meta-avatar> -->
        <nz-list-item-meta-avatar>
          <nz-avatar nzIcon="user"></nz-avatar>
        </nz-list-item-meta-avatar>

        <nz-list-item-meta-title>
          <nz-page-header-subtitle *ngIf="data.currentUser; else redirectToLoginUsername">
            <a
              [routerLink]="['/profile', article.author.username]"
              [queryParams]="{tab: 'posts'}"
              class="username"
            >
              {{ article.author.username }}
            </a>
          </nz-page-header-subtitle>

          <ng-template #redirectToLoginUsername>
            <a [routerLink]="['/sp/login']">{{ article.author.username }}</a>
          </ng-template>
        </nz-list-item-meta-title>

        <nz-list-item-meta-description>
          <h4 *ngIf="data.currentUser; else redirectToLoginTitle">
            <a [routerLink]="['/articles', article.slug]">{{
              article.title
            }}</a>
          </h4>

          <ng-template #redirectToLoginTitle>
            <nz-list-item-meta-title>
              <a routerLink="/sp/login">{{ article.title }}</a
              ><span></span>
            </nz-list-item-meta-title>
          </ng-template>

          <div class="mt10">
            {{ article.description }}
          </div>
          <br />
          <i class="font12">Read more...</i>
        </nz-list-item-meta-description>
      </nz-list-item-meta>
      <ul nz-list-item-actions>
        <nz-list-item-action>
          <app-add-to-favorites
            [isFavorited]="article.favorited"
            [articleSlug]="article.slug"
            [favoritesCount]="article.favoritesCount"
          ></app-add-to-favorites>
        </nz-list-item-action>
      </ul>
      <nz-list-item-extra>
        <a *ngIf="article.tagList[0]" [routerLink]="['/tags', article.tagList[0]]">
          <nz-tag nzColor="blue">
            <span nz-icon nzType="borderless-table"></span>
            {{ article.tagList }}</nz-tag
          >
        </a>
      </nz-list-item-extra>
    </nz-list-item>

    }
    <ng-container *ngIf="data.feed.articlesCount == 0">
      <app-empty-data></app-empty-data>
    </ng-container>
    <br />
    <app-pagination
      [total]="data.feed.articlesCount"
      [currentPage]="currentPage"
    ></app-pagination>
  </div>

  <ng-template #emptyData>
    <app-empty-data></app-empty-data>
  </ng-template>
</nz-list>
